package getDartData;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.util.ArrayList;


public class DartDao {
	static final String JDBC_DRIVER = "org.mariadb.jdbc.Driver";  // jdbc 드라이버 주소
	static final String DB_URL = "jdbc:mariadb://127.0.0.1:3306/test"; // DB 접속 주소
	static final String USERNAME = "root"; // DB ID
	static final String PASSWORD = "0000"; // DB Password
	static final String TABLENAME = "dart_pa_full_test"; 

	 
	

	// DartVo객체를 입력받으면 객체안의 속성에 초기화된 데이터들을 데이터베이스에 인설트하는 메소드입니다.
	public void insertdb(ArrayList<DartVo> db) {
		
		Connection conn = null;
		PreparedStatement stmt = null;
		
		DartVo dvv = null;
		
		
		for(int i =0; i < db.size(); i++) {
			dvv=(DartVo)db.get(i); 
			
			try {
				
				String query = "INSERT INTO "
						+ TABLENAME
						+ "(corp_cls, corp_name, corp_code, stock_code, report_nm, rcept_no, flr_nm, rcept_dt,rm) "
						+ "VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?);";
				Class.forName(JDBC_DRIVER);
				conn = DriverManager.getConnection(DB_URL,USERNAME,PASSWORD); 
				
				stmt = conn.prepareStatement(query); // 쿼리문을 전송할 Statement 객체를 만듭니다.
				
				stmt.setString(1, dvv.getCorp_cls());
				stmt.setString(2, dvv.getCorp_name());
				stmt.setString(3, dvv.getCorp_code());
				stmt.setString(4, dvv.getStock_code());
				stmt.setString(5, dvv.getReport_nm());
				stmt.setString(6, dvv.getRcept_no());
				stmt.setString(7, dvv.getFlr_nm());
				stmt.setString(8, dvv.getRcept_dt());
				stmt.setString(9, dvv.getRm());
				
				stmt.executeUpdate();// 쿼리문을 실행시킵니다.
			    stmt.close();
			    conn.close();
			} catch (ClassNotFoundException e) {
				System.out.println("Class Not Found Exection");
			} catch (SQLException e) {
				System.out.println("SQL Exception : " + e.getMessage());
			}
		}
		
		
	}

}